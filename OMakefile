.PHONY: makelib testlib install clean

open ../../config

OCAMLINCLUDES += $(LIBDIR)

FILES[] =
   logger

LIB = logger

section
   BYTE_ENABLED = true
   NATIVE_ENABLED = false
   OCAMLOPTFLAGS += logger
   OCAMLPPFLAGS = -pp 'camlp4o pa_extend.cmo q_MLast.cmo' 
   OCAMLDEPFLAGS += -pp 'camlp4o pa_extend.cmo q_MLast.cmo'                     
   OCAMLINCLUDES += +camlp4
   pa_logger.cmi:
   pa_logger.cmo:

.DEFAULT: $(OCamlLibrary $(LIB), $(FILES)) \
          pa_logger.cmo

TEST = test
TEST_FILES = test

section
   OCAMLFINDFLAGS = -pp 'camlp4o pa_extend.cmo q_MLast.cmo ./pa_logger.cmo'
   OCAML_OTHER_LIBS = unix strftime
   OCAMLINCLUDES += .
   OCAMLLDFLAGS = logger
   OCAMLPPFLAGS = -pp 'camlp4o ./pa_logger.cmo'
   #OCAMLDEPFLAGS += -pp 'camlp4o pa_extend.cmo q_MLast.cmo'                     
   test.cmx test$(EXT_OBJ):
   test.cmo:
   test.cmi:

section
   OCAML_OTHER_LIBS += unix strftime
   OCAML_LIBS += logger
   OCamlProgram($(TEST), $(TEST_FILES))

testlib: $(TEST)$(EXE)

testview:
   camlp4o ./pa_logger.cmo pr_o.cmo test.ml

IFILES[] =
   logger

ALIBS[] =
   pa_logger.cmo

LibInstall(makelib, $(LIB), $(IFILES), $(ALIBS))

install: makelib

clean:
   $(CLEAN) $(TEST)$(EXE)
  
